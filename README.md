Rewriting recursion using a stack.